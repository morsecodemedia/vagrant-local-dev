# Setup Local Development Box
Tested Versions:
* Vagrant 1.6.5
* VirtualBox 4.3.14

## Installation 
1. Download and install Virtualbox for your host machine
2. Download and install Vagrant for your host machine
3. Clone 'vagrant_local_dev' repo from MorseCodeMeida GitHub account
4. Open Vagrant file:
* Edit line `config.vm.network :public_network, ip: "192.168.1.97"` to match the IP address you are giving your Devbox VM
5. Copy puphpet/config.yaml.orig to puphpet/config.yaml and open config.yaml:
* Find all instances of '**MCMUSERDEVHOME**'. Replace with your sites' directory on your host machine, ex: '/Users/foo/Sites'
* Find all instances of '**MCMUSER**'. Replace with whatever you want to name your Devbox VM, ex: 'bmorse'
6. Open terminal, navigate to the 'Vagrant - Apache' folder, run `vagrant up`
* Vagrant will prompt you for a network device to use to bridge the VM box and the interwebs.  Select whatever the host machine uses.
* Grab some popcorn: Vagrant will now download Ubuntu if this is the first vagrant run, and create your new Devbox VM.  Expect this to take 5-10 minutes plus Ubuntu download time.  Ignore red warnings about fqdn and stdin: is not a tty

##Usage
###Vagrant Commands
A few useful vagrant commands you can run:

* `vagrant up` - Starts the VM, builds if it doesn't not exist.
* `vagrant provision` - Updates the VM with new configurations.  
* `vagrant halt` - Gracefully shuts down the VM.
* `vagrant destroy` - Removes the virtual machine from the host.  
* `vagrant ssh` - Logs into the VM.

###SSH
You can SSH into the Devbox one of 3 ways:

1. `vagrant ssh` in the vagrant folder will login  
2. `ssh vagrant@192.168.1.X` with the password of '**vagrant**'.  You may have to clear your /ssh/known_host entry for this ip address  
3. Use public key found at /puphpet/files/dot/ssh/id_rsa

###SequelPro/Workbench/Other MySQL Tool Setup
You can use **127.0.0.1:3307** in a PHP config file like so:

`$db['default']['hostname'] = '127.0.0.1:3307';  
$db['default']['username'] = 'dev';  
$db['default']['password'] = 'BuEuYhMb5E';`

User **dev** has the following privileges:

`GRANT SELECT, INSERT, UPDATE, DELETE ON *.* TO 'dev'@'%';`

More info: http://stackoverflow.com/a/16138417

# Configuration
## Puphpet
This Puppet/Vagrant setup was generated by using http://www.puphpet.com. You can load the configuration by dragging the **puphpet/config.yaml** file into the browser.

* Some of the puppet manifests were modifed which will not be carried over, so only copy over the new config.yaml if changes are made.

##bootstap.sh
This is a bash script that will run after all of the Vagrant/Puppet magic is finished.  Any extra configuration that isn't covered in config.yaml can go in this file.

## Apache/Nginx
By default, the VM is setup to run Apache, but also has Nginx installed.  You can switch to Nginx with magic.  While the VM is still running:

1. SSH into the VM: `vagrant ssh`
2. Stop the service: `sudo service apache2 stop`
3. Exit out of the VM and open **puphpet/config.conf**
* Set apache -> install to '0'
* Set nginx -> install to '1'
4. Open **bootstrap.sh**. Uncomment the lines under the comment 'remove apache from start...' 
5. Run `vagrant provision`
6. Open up one of your dev sites.  Does it show up?  Then it worked!		